     1                                 %line 1+1 isamod.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 
     8                                 
     9                                 
    10                                 [global progr]
    11                                 [extern exit]
    12                                 
    13                                 [extern TOKENS]
    14                                 
    15                                 [global ISAINT]
    16                                 [global ISASYM]
    17                                 
    18                                 [global ISAPLU]
    19                                 [global ISAMIN]
    20                                 [global ISAAST]
    21                                 [global ISASLA]
    22                                 
    23                                 [global ISALP]
    24                                 [global ISARP]
    25                                 
    26                                 [global ISASEMI]
    27                                 [global ISAEQU]
    28                                 
    29                                 
    30                                 [section .data]
    31                                 LKIND:
    32 00000000 00000000                times 1 dd 0
    33                                 
    34                                 TTYPE:
    35 00000004 00000000                times 1 dd 0
    36                                 
    37                                 OP:
    38 00000008 00000000                times 1 dd 0
    39                                 
    40                                 
    41                                 
    42                                 [section .text]
    43                                 
    44                                 ISAINT:
    45 00000000 55                      push EBP
    46 00000001 89E5                    mov EBP,ESP
    47                                 
    48                                 
    49                                 
    50                                 
    51                                 
    52                                 
    53 00000003 8B5D08                  mov EBX,[EBP+8]
    54 00000006 8B03                    mov EAX,[EBX]
    55 00000008 C1E002                  sal EAX,2
    56 0000000B 05[00000000]            add EAX,TOKENS
    57 00000010 8B00                    mov EAX,[EAX]
    58 00000012 C1F81C                  sar EAX,28
    59 00000015 83E007                  and EAX,7
    60 00000018 A3[00000000]            mov [LKIND],EAX
    61                                 
    62                                 
    63 0000001D A1[00000000]            mov EAX,[LKIND]
    64 00000022 83E802                  sub EAX,2
    65 00000025 7509                    jne LJ1
    66                                 
    67 00000027 B801000000              mov EAX,1
    68                                 
    69 0000002C 89EC                    mov ESP,EBP
    70 0000002E 5D                      pop EBP
    71 0000002F C3                      ret
    72                                 
    73 00000030 EB07                    jmp LJ2
    74                                 LJ1:
    75                                 
    76 00000032 B800000000              mov EAX,0
    77                                 
    78 00000037 89EC                    mov ESP,EBP
    79 00000039 5D                      pop EBP
    80 0000003A C3                      ret
    81                                 
    82                                 LJ2:
    83                                 
    84                                 
    85                                 
    86                                 
    87                                 
    88                                 ISASYM:
    89 0000003B 55                      push EBP
    90 0000003C 89E5                    mov EBP,ESP
    91                                 
    92                                 
    93                                 
    94                                 
    95                                 
    96                                 
    97 0000003E 8B5D08                  mov EBX,[EBP+8]
    98 00000041 8B03                    mov EAX,[EBX]
    99 00000043 C1E002                  sal EAX,2
   100 00000046 05[00000000]            add EAX,TOKENS
   101 0000004B 8B00                    mov EAX,[EAX]
   102 0000004D C1F81C                  sar EAX,28
   103 00000050 83E007                  and EAX,7
   104 00000053 A3[00000000]            mov [LKIND],EAX
   105                                 
   106                                 
   107                                 
   108 00000058 8B5D08                  mov EBX,[EBP+8]
   109 0000005B 8B03                    mov EAX,[EBX]
   110 0000005D 83C003                  add EAX,3
   111 00000060 C1E002                  sal EAX,2
   112 00000063 05[00000000]            add EAX,TOKENS
   113 00000068 8B00                    mov EAX,[EAX]
   114 0000006A C1F808                  sar EAX,8
   115 0000006D 83E00F                  and EAX,15
   116 00000070 A3[00000000]            mov [TTYPE],EAX
   117                                 
   118                                 
   119 00000075 A1[00000000]            mov EAX,[LKIND]
   120 0000007A 48                      dec EAX
   121 0000007B 7511                    jne LJ3
   122                                 
   123 0000007D A1[00000000]            mov EAX,[TTYPE]
   124 00000082 83E803                  sub EAX,3
   125                                 
   126 00000085 7407                    jz LJ4
   127                                 
   128 00000087 B801000000              mov EAX,1
   129                                 
   130 0000008C 89EC                    mov ESP,EBP
   131 0000008E 5D                      pop EBP
   132 0000008F C3                      ret
   133                                 
   134                                 LJ4:
   135                                 LJ3:
   136                                 
   137                                 
   138 00000090 B800000000              mov EAX,0
   139                                 
   140 00000095 89EC                    mov ESP,EBP
   141 00000097 5D                      pop EBP
   142 00000098 C3                      ret
   143                                 
   144                                 
   145                                 
   146                                 
   147                                 ISAPLU:
   148 00000099 55                      push EBP
   149 0000009A 89E5                    mov EBP,ESP
   150                                 
   151                                 
   152                                 
   153                                 
   154                                 
   155                                 
   156 0000009C 8B5D08                  mov EBX,[EBP+8]
   157 0000009F 8B03                    mov EAX,[EBX]
   158 000000A1 C1E002                  sal EAX,2
   159 000000A4 05[00000000]            add EAX,TOKENS
   160 000000A9 8B00                    mov EAX,[EAX]
   161 000000AB C1F81C                  sar EAX,28
   162 000000AE 83E007                  and EAX,7
   163 000000B1 A3[00000000]            mov [LKIND],EAX
   164                                 
   165                                 
   166                                 
   167 000000B6 8B5D08                  mov EBX,[EBP+8]
   168 000000B9 8B03                    mov EAX,[EBX]
   169 000000BB 83C002                  add EAX,2
   170 000000BE C1E002                  sal EAX,2
   171 000000C1 05[00000000]            add EAX,TOKENS
   172 000000C6 8B00                    mov EAX,[EAX]
   173 000000C8 25FF000000              and EAX,255
   174 000000CD A3[00000000]            mov [OP],EAX
   175                                 
   176                                 
   177 000000D2 A1[00000000]            mov EAX,[LKIND]
   178 000000D7 83E804                  sub EAX,4
   179 000000DA 7511                    jne LJ5
   180                                 
   181 000000DC A1[00000000]            mov EAX,[OP]
   182 000000E1 83E832                  sub EAX,50
   183                                 
   184 000000E4 7507                    jne LJ6
   185                                 
   186 000000E6 B801000000              mov EAX,1
   187                                 
   188 000000EB 89EC                    mov ESP,EBP
   189 000000ED 5D                      pop EBP
   190 000000EE C3                      ret
   191                                 
   192                                 LJ6:
   193                                 LJ5:
   194                                 
   195                                 
   196 000000EF B800000000              mov EAX,0
   197                                 
   198 000000F4 89EC                    mov ESP,EBP
   199 000000F6 5D                      pop EBP
   200 000000F7 C3                      ret
   201                                 
   202                                 
   203                                 
   204                                 
   205                                 ISAMIN:
   206 000000F8 55                      push EBP
   207 000000F9 89E5                    mov EBP,ESP
   208                                 
   209                                 
   210                                 
   211                                 
   212                                 
   213                                 
   214 000000FB 8B5D08                  mov EBX,[EBP+8]
   215 000000FE 8B03                    mov EAX,[EBX]
   216 00000100 C1E002                  sal EAX,2
   217 00000103 05[00000000]            add EAX,TOKENS
   218 00000108 8B00                    mov EAX,[EAX]
   219 0000010A C1F81C                  sar EAX,28
   220 0000010D 83E007                  and EAX,7
   221 00000110 A3[00000000]            mov [LKIND],EAX
   222                                 
   223                                 
   224                                 
   225 00000115 8B5D08                  mov EBX,[EBP+8]
   226 00000118 8B03                    mov EAX,[EBX]
   227 0000011A 83C002                  add EAX,2
   228 0000011D C1E002                  sal EAX,2
   229 00000120 05[00000000]            add EAX,TOKENS
   230 00000125 8B00                    mov EAX,[EAX]
   231 00000127 25FF000000              and EAX,255
   232 0000012C A3[00000000]            mov [OP],EAX
   233                                 
   234                                 
   235 00000131 A1[00000000]            mov EAX,[LKIND]
   236 00000136 83E804                  sub EAX,4
   237 00000139 7511                    jne LJ7
   238                                 
   239 0000013B A1[00000000]            mov EAX,[OP]
   240 00000140 83E833                  sub EAX,51
   241                                 
   242 00000143 7507                    jne LJ8
   243                                 
   244 00000145 B801000000              mov EAX,1
   245                                 
   246 0000014A 89EC                    mov ESP,EBP
   247 0000014C 5D                      pop EBP
   248 0000014D C3                      ret
   249                                 
   250                                 LJ8:
   251                                 LJ7:
   252                                 
   253                                 
   254 0000014E B800000000              mov EAX,0
   255                                 
   256 00000153 89EC                    mov ESP,EBP
   257 00000155 5D                      pop EBP
   258 00000156 C3                      ret
   259                                 
   260                                 
   261                                 
   262                                 
   263                                 ISAAST:
   264 00000157 55                      push EBP
   265 00000158 89E5                    mov EBP,ESP
   266                                 
   267                                 
   268                                 
   269                                 
   270                                 
   271                                 
   272 0000015A 8B5D08                  mov EBX,[EBP+8]
   273 0000015D 8B03                    mov EAX,[EBX]
   274 0000015F C1E002                  sal EAX,2
   275 00000162 05[00000000]            add EAX,TOKENS
   276 00000167 8B00                    mov EAX,[EAX]
   277 00000169 C1F81C                  sar EAX,28
   278 0000016C 83E007                  and EAX,7
   279 0000016F A3[00000000]            mov [LKIND],EAX
   280                                 
   281                                 
   282                                 
   283 00000174 8B5D08                  mov EBX,[EBP+8]
   284 00000177 8B03                    mov EAX,[EBX]
   285 00000179 83C002                  add EAX,2
   286 0000017C C1E002                  sal EAX,2
   287 0000017F 05[00000000]            add EAX,TOKENS
   288 00000184 8B00                    mov EAX,[EAX]
   289 00000186 25FF000000              and EAX,255
   290 0000018B A3[00000000]            mov [OP],EAX
   291                                 
   292                                 
   293 00000190 A1[00000000]            mov EAX,[LKIND]
   294 00000195 83E804                  sub EAX,4
   295 00000198 7511                    jne LJ9
   296                                 
   297 0000019A A1[00000000]            mov EAX,[OP]
   298 0000019F 83E835                  sub EAX,53
   299                                 
   300 000001A2 7507                    jne LJ10
   301                                 
   302 000001A4 B801000000              mov EAX,1
   303                                 
   304 000001A9 89EC                    mov ESP,EBP
   305 000001AB 5D                      pop EBP
   306 000001AC C3                      ret
   307                                 
   308                                 LJ10:
   309                                 LJ9:
   310                                 
   311                                 
   312 000001AD B800000000              mov EAX,0
   313                                 
   314 000001B2 89EC                    mov ESP,EBP
   315 000001B4 5D                      pop EBP
   316 000001B5 C3                      ret
   317                                 
   318                                 
   319                                 
   320                                 
   321                                 ISASLA:
   322 000001B6 55                      push EBP
   323 000001B7 89E5                    mov EBP,ESP
   324                                 
   325                                 
   326                                 
   327                                 
   328                                 
   329                                 
   330 000001B9 8B5D08                  mov EBX,[EBP+8]
   331 000001BC 8B03                    mov EAX,[EBX]
   332 000001BE C1E002                  sal EAX,2
   333 000001C1 05[00000000]            add EAX,TOKENS
   334 000001C6 8B00                    mov EAX,[EAX]
   335 000001C8 C1F81C                  sar EAX,28
   336 000001CB 83E007                  and EAX,7
   337 000001CE A3[00000000]            mov [LKIND],EAX
   338                                 
   339                                 
   340                                 
   341 000001D3 8B5D08                  mov EBX,[EBP+8]
   342 000001D6 8B03                    mov EAX,[EBX]
   343 000001D8 83C002                  add EAX,2
   344 000001DB C1E002                  sal EAX,2
   345 000001DE 05[00000000]            add EAX,TOKENS
   346 000001E3 8B00                    mov EAX,[EAX]
   347 000001E5 25FF000000              and EAX,255
   348 000001EA A3[00000000]            mov [OP],EAX
   349                                 
   350                                 
   351 000001EF A1[00000000]            mov EAX,[LKIND]
   352 000001F4 83E804                  sub EAX,4
   353 000001F7 7511                    jne LJ11
   354                                 
   355 000001F9 A1[00000000]            mov EAX,[OP]
   356 000001FE 83E836                  sub EAX,54
   357                                 
   358 00000201 7507                    jne LJ12
   359                                 
   360 00000203 B801000000              mov EAX,1
   361                                 
   362 00000208 89EC                    mov ESP,EBP
   363 0000020A 5D                      pop EBP
   364 0000020B C3                      ret
   365                                 
   366                                 LJ12:
   367                                 LJ11:
   368                                 
   369                                 
   370 0000020C B800000000              mov EAX,0
   371                                 
   372 00000211 89EC                    mov ESP,EBP
   373 00000213 5D                      pop EBP
   374 00000214 C3                      ret
   375                                 
   376                                 
   377                                 
   378                                 
   379                                 ISALP:
   380 00000215 55                      push EBP
   381 00000216 89E5                    mov EBP,ESP
   382                                 
   383                                 
   384                                 
   385                                 
   386                                 
   387                                 
   388 00000218 8B5D08                  mov EBX,[EBP+8]
   389 0000021B 8B03                    mov EAX,[EBX]
   390 0000021D C1E002                  sal EAX,2
   391 00000220 05[00000000]            add EAX,TOKENS
   392 00000225 8B00                    mov EAX,[EAX]
   393 00000227 C1F81C                  sar EAX,28
   394 0000022A 83E007                  and EAX,7
   395 0000022D A3[00000000]            mov [LKIND],EAX
   396                                 
   397                                 
   398                                 
   399 00000232 8B5D08                  mov EBX,[EBP+8]
   400 00000235 8B03                    mov EAX,[EBX]
   401 00000237 83C002                  add EAX,2
   402 0000023A C1E002                  sal EAX,2
   403 0000023D 05[00000000]            add EAX,TOKENS
   404 00000242 8B00                    mov EAX,[EAX]
   405 00000244 25FF000000              and EAX,255
   406 00000249 A3[00000000]            mov [OP],EAX
   407                                 
   408                                 
   409 0000024E A1[00000000]            mov EAX,[LKIND]
   410 00000253 83E804                  sub EAX,4
   411 00000256 7511                    jne LJ13
   412                                 
   413 00000258 A1[00000000]            mov EAX,[OP]
   414 0000025D 83E840                  sub EAX,64
   415                                 
   416 00000260 7507                    jne LJ14
   417                                 
   418 00000262 B801000000              mov EAX,1
   419                                 
   420 00000267 89EC                    mov ESP,EBP
   421 00000269 5D                      pop EBP
   422 0000026A C3                      ret
   423                                 
   424                                 LJ14:
   425                                 LJ13:
   426                                 
   427                                 
   428 0000026B B800000000              mov EAX,0
   429                                 
   430 00000270 89EC                    mov ESP,EBP
   431 00000272 5D                      pop EBP
   432 00000273 C3                      ret
   433                                 
   434                                 
   435                                 
   436                                 
   437                                 ISARP:
   438 00000274 55                      push EBP
   439 00000275 89E5                    mov EBP,ESP
   440                                 
   441                                 
   442                                 
   443                                 
   444                                 
   445                                 
   446 00000277 8B5D08                  mov EBX,[EBP+8]
   447 0000027A 8B03                    mov EAX,[EBX]
   448 0000027C C1E002                  sal EAX,2
   449 0000027F 05[00000000]            add EAX,TOKENS
   450 00000284 8B00                    mov EAX,[EAX]
   451 00000286 C1F81C                  sar EAX,28
   452 00000289 83E007                  and EAX,7
   453 0000028C A3[00000000]            mov [LKIND],EAX
   454                                 
   455                                 
   456                                 
   457 00000291 8B5D08                  mov EBX,[EBP+8]
   458 00000294 8B03                    mov EAX,[EBX]
   459 00000296 83C002                  add EAX,2
   460 00000299 C1E002                  sal EAX,2
   461 0000029C 05[00000000]            add EAX,TOKENS
   462 000002A1 8B00                    mov EAX,[EAX]
   463 000002A3 25FF000000              and EAX,255
   464 000002A8 A3[00000000]            mov [OP],EAX
   465                                 
   466                                 
   467 000002AD A1[00000000]            mov EAX,[LKIND]
   468 000002B2 83E804                  sub EAX,4
   469 000002B5 7511                    jne LJ15
   470                                 
   471 000002B7 A1[00000000]            mov EAX,[OP]
   472 000002BC 83E841                  sub EAX,65
   473                                 
   474 000002BF 7507                    jne LJ16
   475                                 
   476 000002C1 B801000000              mov EAX,1
   477                                 
   478 000002C6 89EC                    mov ESP,EBP
   479 000002C8 5D                      pop EBP
   480 000002C9 C3                      ret
   481                                 
   482                                 LJ16:
   483                                 LJ15:
   484                                 
   485                                 
   486 000002CA B800000000              mov EAX,0
   487                                 
   488 000002CF 89EC                    mov ESP,EBP
   489 000002D1 5D                      pop EBP
   490 000002D2 C3                      ret
   491                                 
   492                                 
   493                                 
   494                                 
   495                                 ISASEMI:
   496 000002D3 55                      push EBP
   497 000002D4 89E5                    mov EBP,ESP
   498                                 
   499                                 
   500                                 
   501                                 
   502                                 
   503                                 
   504 000002D6 8B5D08                  mov EBX,[EBP+8]
   505 000002D9 8B03                    mov EAX,[EBX]
   506 000002DB C1E002                  sal EAX,2
   507 000002DE 05[00000000]            add EAX,TOKENS
   508 000002E3 8B00                    mov EAX,[EAX]
   509 000002E5 C1F81C                  sar EAX,28
   510 000002E8 83E007                  and EAX,7
   511 000002EB A3[00000000]            mov [LKIND],EAX
   512                                 
   513                                 
   514                                 
   515 000002F0 8B5D08                  mov EBX,[EBP+8]
   516 000002F3 8B03                    mov EAX,[EBX]
   517 000002F5 83C002                  add EAX,2
   518 000002F8 C1E002                  sal EAX,2
   519 000002FB 05[00000000]            add EAX,TOKENS
   520 00000300 8B00                    mov EAX,[EAX]
   521 00000302 25FF000000              and EAX,255
   522 00000307 A3[00000000]            mov [OP],EAX
   523                                 
   524                                 
   525 0000030C A1[00000000]            mov EAX,[LKIND]
   526 00000311 83E804                  sub EAX,4
   527 00000314 7511                    jne LJ17
   528                                 
   529 00000316 A1[00000000]            mov EAX,[OP]
   530 0000031B 83E83F                  sub EAX,63
   531                                 
   532 0000031E 7507                    jne LJ18
   533                                 
   534 00000320 B801000000              mov EAX,1
   535                                 
   536 00000325 89EC                    mov ESP,EBP
   537 00000327 5D                      pop EBP
   538 00000328 C3                      ret
   539                                 
   540                                 LJ18:
   541                                 LJ17:
   542                                 
   543                                 
   544 00000329 B800000000              mov EAX,0
   545                                 
   546 0000032E 89EC                    mov ESP,EBP
   547 00000330 5D                      pop EBP
   548 00000331 C3                      ret
   549                                 
   550                                 
   551                                 
   552                                 
   553                                 ISAEQU:
   554 00000332 55                      push EBP
   555 00000333 89E5                    mov EBP,ESP
   556                                 
   557                                 
   558                                 
   559                                 
   560                                 
   561                                 
   562 00000335 8B5D08                  mov EBX,[EBP+8]
   563 00000338 8B03                    mov EAX,[EBX]
   564 0000033A C1E002                  sal EAX,2
   565 0000033D 05[00000000]            add EAX,TOKENS
   566 00000342 8B00                    mov EAX,[EAX]
   567 00000344 C1F81C                  sar EAX,28
   568 00000347 83E007                  and EAX,7
   569 0000034A A3[00000000]            mov [LKIND],EAX
   570                                 
   571                                 
   572                                 
   573 0000034F 8B5D08                  mov EBX,[EBP+8]
   574 00000352 8B03                    mov EAX,[EBX]
   575 00000354 83C002                  add EAX,2
   576 00000357 C1E002                  sal EAX,2
   577 0000035A 05[00000000]            add EAX,TOKENS
   578 0000035F 8B00                    mov EAX,[EAX]
   579 00000361 25FF000000              and EAX,255
   580 00000366 A3[00000000]            mov [OP],EAX
   581                                 
   582                                 
   583 0000036B A1[00000000]            mov EAX,[LKIND]
   584 00000370 83E804                  sub EAX,4
   585 00000373 7511                    jne LJ19
   586                                 
   587 00000375 A1[00000000]            mov EAX,[OP]
   588 0000037A 83E843                  sub EAX,67
   589                                 
   590 0000037D 7507                    jne LJ20
   591                                 
   592 0000037F B801000000              mov EAX,1
   593                                 
   594 00000384 89EC                    mov ESP,EBP
   595 00000386 5D                      pop EBP
   596 00000387 C3                      ret
   597                                 
   598                                 LJ20:
   599                                 LJ19:
   600                                 
   601                                 
   602 00000388 B800000000              mov EAX,0
   603                                 
   604 0000038D 89EC                    mov ESP,EBP
   605 0000038F 5D                      pop EBP
   606 00000390 C3                      ret
   607                                 
   608                                 
   609                                 
   610                                  end
