* testlex.s1 -- Test LEX.S1, CRB, Jan 2, 2014

  ENTRY TESTLEX;
  BEGIN TESTLEX;
  START TESTLEX;
  ENTRY BUFF;                   * make BUFF buffer global for LEX

  EXTERNAL PROC READ,WRITE;
  EXTERNAL PROC LEX;

  DCL BUFF(128);
  DCL INCH=1,OUTCH=3,STATUS;
  DCL EOF=0;
  DCL LEXEME(120);
  MSG GREET='Begin Small LEX Test'
  DCL KIND;
  DCL ICHAR;

LABEL TESTLEX;
  CALL WRITE(OUTCH,GREET);
  REPEAT 
    STATUS=READ(INCH,BUFF);
    CALL WRITE(OUTCH,BUFF);
    ICHAR=1;
    DO WHILE ICHAR LT BUFF;    * until end of line
      KIND=LEX(ICHAR,LEXEME);
      CALL WRITE(OUTCH,LEXEME);
      ENDDO
    UNTIL STATUS EQ EOF;
  RETURN

END
