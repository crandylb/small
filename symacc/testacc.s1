* TESTACC.S1 -- Test Symbol Table Access, CRB, Feb 14, 2014

ENT TESTACC;
BEGIN TESTACC;
START TESTACC;

EXT PROC LOOKS,GETS,PUTS,GETWRD;
EXT PROC A2B40,B402A;
EXT PROC READ,WRITE,IFORM;
EXT PROC LEX,CAT2;

MSG IFS='IF';
MSG THENS='THEN';
MSG ELSES='ELSE';
MSG PROCES='PROCEDURE';
MSG PROCS='PROC';
MSG GREET='Begin SYMACC Test';
MSG TESTIT='Test:               ';
DCL STAR=('*');
DCL SLASH=('/');
DCL PLUS=('+');
DCL MINUS=('-');
DCL LPAREN=40;
DCL RPAREN=41;
DCL OUTCH=3;
DCL INDEX,VAL,TAG,WORDS,TTYPE;
DCL LIST(20);
MSG SCRATCH='          ';

LABEL TESTACC;
  CALL WRITE(OUTCH,GREET);
  TESTIT=7;
  CALL CAT2(TESTIT,IFS);
  CALL WRITE(OUTCH,TESTIT);
  WORDS=A2B40(IFS);
  CALL IFORM(WORDS,SCRATCH);
  CALL WRITE(OUTCH,SCRATCH);
  VAL=2;                        * IF
  TTYPE=3;                      * Token type = Keyword
  TAG=TTYPE SHL 8;
  INDEX=LOOKS(WORDS,VAL,TAG);
  SCRATCH=10;
  CALL IFORM(INDEX,SCRATCH);
  CALL WRITE(OUTCH,SCRATCH);
  CALL B402A(WORDS,SCRATCH);
  CALL WRITE(OUTCH,SCRATCH);
  RETURN;
END



