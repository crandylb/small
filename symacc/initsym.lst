     1                                 %line 1+1 initsym.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 
     8                                 
     9                                 [global progr]
    10                                 [extern exit]
    11                                 
    12                                 [global INITSYM]
    13                                 
    14                                 [global DMPLIST]
    15                                 
    16                                 [global BUFF]
    17                                 
    18                                 [global INIT]
    19                                 [section .text]
    20                                 progr:
    21 00000000 55                      push EBP
    22 00000001 89E5                    mov EBP,ESP
    23 00000003 EBFE                    jmp INIT
    24                                 
    25                                 
    26                                 [extern READ]
    27                                 [extern WRITE]
    28                                 
    29                                 [extern LEX]
    30                                 
    31                                 [extern A2B40]
    32                                 [extern B402A]
    33                                 
    34                                 [extern A2B40L]
    35                                 
    36                                 [extern LOOKS]
    37                                 [extern GETS]
    38                                 [extern PUTS]
    39                                 [extern GETWRD]
    40                                 
    41                                 [extern IREAD]
    42                                 [extern IFORM]
    43                                 [extern CAT2]
    44                                 
    45                                 [extern COLLS]
    46                                 [extern MASKV]
    47                                 
    48                                 
    49                                 [section .data]
    50                                 I:
    51 00000000 00000000                times 1 dd 0
    52                                 J:
    53 00000004 00000000                times 1 dd 0
    54                                 EOF:
    55 00000008 00000000                dd 0
    56                                 STATUS:
    57 0000000C 00000000                times 1 dd 0
    58                                 
    59                                 BUFF:
    60 00000010 00000000<rept>          times 128 dd 0
    61                                 
    62                                 INCH:
    63 00000210 01000000                dd 1
    64                                 SCRCH:
    65 00000214 02000000                dd 2
    66                                 OUTCH:
    67 00000218 03000000                dd 3
    68                                 
    69                                 LEXEME:
    70 0000021C 00000000<rept>          times 5 dd 0
    71                                 
    72                                 INDEX:
    73 00000230 00000000                times 1 dd 0
    74                                 WORDS:
    75 00000234 00000000                times 1 dd 0
    76                                 KIND:
    77 00000238 00000000                times 1 dd 0
    78                                 TTYPE:
    79 0000023C 00000000                times 1 dd 0
    80                                 TAG:
    81 00000240 00000000                times 1 dd 0
    82                                 TAGS:
    83 00000244 00000000                times 1 dd 0
    84                                 VAL:
    85 00000248 00000000                times 1 dd 0
    86                                 ATTR:
    87 0000024C 00000000                times 1 dd 0
    88                                 
    89                                 COUNT:
    90 00000250 00000000                dd 0
    91                                 LIST:
    92 00000254 00000000<rept>          times 61 dd 0
    93                                 
    94                                 STAR:
    95 00000348 2A000000                dd 42
    96                                 
    97                                 DOT:
    98 0000034C 2E000000                dd 46
    99                                 
   100                                 QUOTE:
   101 00000350 27000000                dd 39
   102                                 
   103                                 BLANKS:
   104 00000354 0A000000                dd 10
   105 00000358 20000000                dd 32
   106 0000035C 20000000                dd 32
   107 00000360 20000000                dd 32
   108 00000364 20000000                dd 32
   109 00000368 20000000                dd 32
   110 0000036C 20000000                dd 32
   111 00000370 20000000                dd 32
   112 00000374 20000000                dd 32
   113 00000378 20000000                dd 32
   114 0000037C 20000000                dd 32
   115                                 
   116                                 SCRATCH:
   117 00000380 0A000000                dd 10
   118 00000384 20000000                dd 32
   119 00000388 20000000                dd 32
   120 0000038C 20000000                dd 32
   121 00000390 20000000                dd 32
   122 00000394 20000000                dd 32
   123 00000398 20000000                dd 32
   124 0000039C 20000000                dd 32
   125 000003A0 20000000                dd 32
   126 000003A4 20000000                dd 32
   127 000003A8 20000000                dd 32
   128                                 
   129                                 COLLISIONS:
   130 000003AC 0C000000                dd 12
   131 000003B0 43000000                dd 67
   132 000003B4 6F000000                dd 111
   133 000003B8 6C000000                dd 108
   134 000003BC 6C000000                dd 108
   135 000003C0 69000000                dd 105
   136 000003C4 73000000                dd 115
   137 000003C8 69000000                dd 105
   138 000003CC 6F000000                dd 111
   139 000003D0 6E000000                dd 110
   140 000003D4 73000000                dd 115
   141 000003D8 3A000000                dd 58
   142 000003DC 20000000                dd 32
   143                                 
   144                                 
   145                                 ANC:
   146 000003E0 00000000                times 1 dd 0
   147                                 
   148                                 
   149                                 [section .text]
   150                                 INIT:
   151                                 
   152                                 
   153 00000005 E804000000              call INITSYM
   154                                 
   155                                 
   156 0000000A E84D020000              call DMPLIST
   157                                 
   158                                 
   159 0000000F 89EC                    mov ESP,EBP
   160 00000011 5D                      pop EBP
   161 00000012 C3                      ret
   162                                 
   163                                 
   164                                 
   165                                 INITSYM:
   166 00000013 55                      push EBP
   167 00000014 89E5                    mov EBP,ESP
   168                                 
   169                                 
   170                                 
   171                                 
   172 00000016 B8FF7F0000              mov EAX,32767
   173 0000001B D1E0                    sal EAX,1
   174 0000001D 83C801                  or EAX,1
   175 00000020 A3[00000000]            mov [MASKV],EAX
   176                                 
   177                                 
   178                                 
   179 00000025 68[00000000]            push SCRCH
   180 0000002A 68[00000000]            push BUFF
   181 0000002F E8(F6FFFFFF)            call READ
   182 00000034 83C408                  add ESP,4*2
   183 00000037 A3[00000000]            mov [STATUS],EAX
   184                                 
   185                                 LJ2:
   186                                 
   187 0000003C A1[00000000]            mov EAX,[STATUS]
   188 00000041 2B05[00000000]          sub EAX,[EOF]
   189 00000047 0F840A020000            jz LJ3
   190                                 
   191                                 
   192 0000004D B801000000              mov EAX,1
   193 00000052 C1E002                  sal EAX,2
   194 00000055 05[00000000]            add EAX,BUFF
   195 0000005A 8B00                    mov EAX,[EAX]
   196 0000005C 2B05[00000000]          sub EAX,[STAR]
   197                                 
   198 00000062 0F84D3010000            jz LJ4
   199                                 
   200                                 
   201 00000068 B801000000              mov EAX,1
   202 0000006D A3[00000000]            mov [I],EAX
   203                                 
   204                                 
   205                                 
   206                                 
   207 00000072 68[00000000]            push I
   208 00000077 68[00000000]            push LEXEME
   209 0000007C E8(F6FFFFFF)            call LEX
   210 00000081 83C408                  add ESP,4*2
   211 00000084 A3[00000000]            mov [KIND],EAX
   212                                 
   213                                 
   214 00000089 A1[00000000]            mov EAX,[LEXEME]
   215 0000008E 25FF000000              and EAX,255
   216 00000093 A3[00000000]            mov [ANC],EAX
   217                                 
   218                                 
   219 00000098 A1[00000000]            mov EAX,[ANC]
   220 0000009D C1E002                  sal EAX,2
   221 000000A0 05[00000000]            add EAX,BUFF
   222 000000A5 8B00                    mov EAX,[EAX]
   223 000000A7 2B05[00000000]          sub EAX,[QUOTE]
   224 000000AD 753E                    jne LJ6
   225                                 
   226                                 
   227 000000AF A1[00000000]            mov EAX,[ANC]
   228 000000B4 40                      inc EAX
   229 000000B5 C1E002                  sal EAX,2
   230 000000B8 05[00000000]            add EAX,BUFF
   231 000000BD 8B00                    mov EAX,[EAX]
   232 000000BF 6BC03D                  imul EAX,61
   233 000000C2 A3[00000000]            mov [WORDS],EAX
   234                                 
   235                                 
   236 000000C7 B801000000              mov EAX,1
   237 000000CC A3[00000000]            mov [TAGS],EAX
   238                                 
   239                                 
   240                                 
   241 000000D1 68[00000000]            push WORDS
   242 000000D6 68[00000000]            push VAL
   243 000000DB 68[00000000]            push TAG
   244 000000E0 E8(F6FFFFFF)            call LOOKS
   245 000000E5 83C40C                  add ESP,4*3
   246 000000E8 A3[00000000]            mov [INDEX],EAX
   247                                 
   248 000000ED EB33                    jmp LJ8
   249                                 LJ6:
   250                                 
   251                                 
   252                                 
   253 000000EF 68[00000000]            push LEXEME
   254 000000F4 68[00000000]            push BUFF
   255 000000F9 E8(F6FFFFFF)            call A2B40L
   256 000000FE 83C408                  add ESP,4*2
   257 00000101 A3[00000000]            mov [WORDS],EAX
   258                                 
   259                                 
   260 00000106 B800000000              mov EAX,0
   261 0000010B A3[00000000]            mov [TAGS],EAX
   262                                 
   263                                 
   264 00000110 B801000000              mov EAX,1
   265 00000115 C1E002                  sal EAX,2
   266 00000118 05[00000000]            add EAX,LEXEME
   267 0000011D 8B00                    mov EAX,[EAX]
   268 0000011F A3[00000000]            mov [INDEX],EAX
   269                                 
   270                                 LJ8:
   271                                 
   272                                 
   273                                 
   274                                 
   275 00000124 68[00000000]            push I
   276 00000129 68[00000000]            push LEXEME
   277 0000012E E8(F6FFFFFF)            call LEX
   278 00000133 83C408                  add ESP,4*2
   279 00000136 A3[00000000]            mov [KIND],EAX
   280                                 
   281                                 
   282 0000013B B801000000              mov EAX,1
   283 00000140 C1E002                  sal EAX,2
   284 00000143 05[00000000]            add EAX,LEXEME
   285 00000148 8B00                    mov EAX,[EAX]
   286 0000014A A3[00000000]            mov [TTYPE],EAX
   287                                 
   288                                 
   289                                 
   290                                 
   291 0000014F 68[00000000]            push I
   292 00000154 68[00000000]            push LEXEME
   293 00000159 E8(F6FFFFFF)            call LEX
   294 0000015E 83C408                  add ESP,4*2
   295 00000161 A3[00000000]            mov [KIND],EAX
   296                                 
   297                                 
   298 00000166 B801000000              mov EAX,1
   299 0000016B C1E002                  sal EAX,2
   300 0000016E 05[00000000]            add EAX,LEXEME
   301 00000173 8B00                    mov EAX,[EAX]
   302 00000175 A3[00000000]            mov [VAL],EAX
   303                                 
   304                                 
   305                                 
   306                                 
   307 0000017A 68[00000000]            push I
   308 0000017F 68[00000000]            push LEXEME
   309 00000184 E8(F6FFFFFF)            call LEX
   310 00000189 83C408                  add ESP,4*2
   311 0000018C A3[00000000]            mov [KIND],EAX
   312                                 
   313                                 
   314 00000191 B801000000              mov EAX,1
   315 00000196 C1E002                  sal EAX,2
   316 00000199 05[00000000]            add EAX,LEXEME
   317 0000019E 8B00                    mov EAX,[EAX]
   318 000001A0 A3[00000000]            mov [KIND],EAX
   319                                 
   320                                 
   321 000001A5 A1[00000000]            mov EAX,[TAGS]
   322 000001AA C1E004                  sal EAX,4
   323 000001AD 0B05[00000000]          or EAX,[TTYPE]
   324 000001B3 C1E008                  sal EAX,8
   325 000001B6 0B05[00000000]          or EAX,[KIND]
   326 000001BC A3[00000000]            mov [TAG],EAX
   327                                 
   328                                 
   329                                 
   330                                 
   331 000001C1 68[00000000]            push I
   332 000001C6 68[00000000]            push LEXEME
   333 000001CB E8(F6FFFFFF)            call LEX
   334 000001D0 83C408                  add ESP,4*2
   335 000001D3 A3[00000000]            mov [KIND],EAX
   336                                 
   337                                 
   338 000001D8 B801000000              mov EAX,1
   339 000001DD C1E002                  sal EAX,2
   340 000001E0 05[00000000]            add EAX,LEXEME
   341 000001E5 8B00                    mov EAX,[EAX]
   342 000001E7 A3[00000000]            mov [ATTR],EAX
   343                                 
   344                                 
   345 000001EC A1[00000000]            mov EAX,[ATTR]
   346 000001F1 C1E008                  sal EAX,8
   347 000001F4 0B05[00000000]          or EAX,[VAL]
   348 000001FA A3[00000000]            mov [VAL],EAX
   349                                 
   350                                 
   351                                 
   352 000001FF 68[00000000]            push INDEX
   353 00000204 68[00000000]            push VAL
   354 00000209 68[00000000]            push TAG
   355 0000020E E8(F6FFFFFF)            call PUTS
   356 00000213 83C40C                  add ESP,4*3
   357                                 
   358                                 
   359 00000216 A1[00000000]            mov EAX,[COUNT]
   360 0000021B 40                      inc EAX
   361 0000021C A3[00000000]            mov [COUNT],EAX
   362                                 
   363                                 
   364 00000221 A1[00000000]            mov EAX,[COUNT]
   365 00000226 C1E002                  sal EAX,2
   366 00000229 05[00000000]            add EAX,LIST
   367 0000022E A3[00000000]            mov [T1Z],EAX
   368 00000233 A1[00000000]            mov EAX,[INDEX]
   369 00000238 89C2                    mov EDX,EAX
   370 0000023A A1[00000000]            mov EAX,[T1Z]
   371 0000023F 8910                    mov [EAX],EDX
   372                                 
   373                                 LJ4:
   374                                 
   375                                 
   376                                 
   377 00000241 68[00000000]            push SCRCH
   378 00000246 68[00000000]            push BUFF
   379 0000024B E8(F6FFFFFF)            call READ
   380 00000250 83C408                  add ESP,4*2
   381 00000253 A3[00000000]            mov [STATUS],EAX
   382                                 
   383 00000258 E9DAFDFFFF              jmp LJ2
   384                                 LJ3:
   385                                 
   386                                 
   387 0000025D 89EC                    mov ESP,EBP
   388 0000025F 5D                      pop EBP
   389 00000260 C3                      ret
   390                                 
   391                                 [section .data]
   392                                 T1Z:
   393 000003E4 00000000<rept>          times 2 dd 0
   394                                 [section .text]
   395                                 
   396                                 
   397                                 
   398                                 DMPLIST:
   399 00000261 55                      push EBP
   400 00000262 89E5                    mov EBP,ESP
   401                                 
   402                                 
   403                                 
   404                                 
   405 00000264 B801000000              mov EAX,1
   406 00000269 A3[00000000]            mov [I],EAX
   407                                 
   408                                 LJ16:
   409                                 
   410 0000026E A1[00000000]            mov EAX,[I]
   411 00000273 2B05[00000000]          sub EAX,[COUNT]
   412 00000279 0F8F64010000            jg LJ17
   413                                 
   414                                 
   415 0000027F A1[00000000]            mov EAX,[I]
   416 00000284 C1E002                  sal EAX,2
   417 00000287 05[00000000]            add EAX,LIST
   418 0000028C 8B00                    mov EAX,[EAX]
   419 0000028E A3[00000000]            mov [INDEX],EAX
   420                                 
   421                                 
   422 00000293 68[00000000]            push INDEX
   423 00000298 68[00000000]            push WORDS
   424 0000029D E8(F6FFFFFF)            call GETWRD
   425 000002A2 83C408                  add ESP,4*2
   426                                 
   427                                 
   428 000002A5 68[00000000]            push INDEX
   429 000002AA 68[00000000]            push VAL
   430 000002AF 68[00000000]            push TAG
   431 000002B4 E8(F6FFFFFF)            call GETS
   432 000002B9 83C40C                  add ESP,4*3
   433                                 
   434                                 
   435 000002BC A1[00000000]            mov EAX,[TAG]
   436 000002C1 C1F808                  sar EAX,8
   437 000002C4 A3[00000000]            mov [TTYPE],EAX
   438                                 
   439                                 
   440 000002C9 A1[00000000]            mov EAX,[TTYPE]
   441 000002CE C1F804                  sar EAX,4
   442 000002D1 A3[00000000]            mov [TAGS],EAX
   443                                 
   444                                 
   445 000002D6 A1[00000000]            mov EAX,[TTYPE]
   446 000002DB 83E00F                  and EAX,15
   447 000002DE A3[00000000]            mov [TTYPE],EAX
   448                                 
   449                                 
   450 000002E3 B800000000              mov EAX,0
   451 000002E8 A3[00000000]            mov [BUFF],EAX
   452                                 
   453                                 
   454 000002ED 68[00000000]            push BUFF
   455 000002F2 68[00000000]            push BLANKS
   456 000002F7 E8(F6FFFFFF)            call CAT2
   457 000002FC 83C408                  add ESP,4*2
   458                                 
   459                                 
   460 000002FF B800000000              mov EAX,0
   461 00000304 A3[00000000]            mov [BUFF],EAX
   462                                 
   463                                 
   464 00000309 A1[00000000]            mov EAX,[TAGS]
   465 0000030E 83E001                  and EAX,1
   466 00000311 09C0                    or EAX,EAX
   467 00000313 7428                    jz LJ21
   468                                 
   469                                 
   470 00000315 B801000000              mov EAX,1
   471 0000031A C1E002                  sal EAX,2
   472 0000031D 05[00000000]            add EAX,BUFF
   473 00000322 A3[00000000]            mov [T3Z1],EAX
   474 00000327 A1[00000000]            mov EAX,[WORDS]
   475                                 
   476 0000032C 99                      cdq
   477 0000032D B93D000000              mov ECX,61
   478 00000332 F7F9                    idiv dword ECX
   479 00000334 89C2                    mov EDX,EAX
   480 00000336 A1[00000000]            mov EAX,[T3Z1]
   481 0000033B 8910                    mov [EAX],EDX
   482                                 
   483 0000033D EB10                    jmp LJ22
   484                                 LJ21:
   485                                 
   486                                 
   487 0000033F 68[00000000]            push WORDS
   488 00000344 68[00000000]            push BUFF
   489 00000349 E8(F6FFFFFF)            call B402A
   490 0000034E 83C408                  add ESP,4*2
   491                                 
   492                                 LJ22:
   493                                 
   494                                 
   495 00000351 B808000000              mov EAX,8
   496 00000356 A3[00000000]            mov [BUFF],EAX
   497                                 
   498                                 
   499 0000035B 68[00000000]            push VAL
   500 00000360 68[00000000]            push SCRATCH
   501 00000365 E8(F6FFFFFF)            call IFORM
   502 0000036A 83C408                  add ESP,4*2
   503                                 
   504                                 
   505 0000036D 68[00000000]            push BUFF
   506 00000372 68[00000000]            push SCRATCH
   507 00000377 E8(F6FFFFFF)            call CAT2
   508 0000037C 83C408                  add ESP,4*2
   509                                 
   510                                 
   511 0000037F 68[00000000]            push TAG
   512 00000384 68[00000000]            push SCRATCH
   513 00000389 E8(F6FFFFFF)            call IFORM
   514 0000038E 83C408                  add ESP,4*2
   515                                 
   516                                 
   517 00000391 68[00000000]            push BUFF
   518 00000396 68[00000000]            push SCRATCH
   519 0000039B E8(F6FFFFFF)            call CAT2
   520 000003A0 83C408                  add ESP,4*2
   521                                 
   522                                 
   523                                 
   524 000003A3 68[00000000]            push INDEX
   525 000003A8 68[00000000]            push SCRATCH
   526 000003AD E8(F6FFFFFF)            call IFORM
   527 000003B2 83C408                  add ESP,4*2
   528                                 
   529                                 
   530 000003B5 68[00000000]            push BUFF
   531 000003BA 68[00000000]            push SCRATCH
   532 000003BF E8(F6FFFFFF)            call CAT2
   533 000003C4 83C408                  add ESP,4*2
   534                                 
   535                                 
   536 000003C7 68[00000000]            push OUTCH
   537 000003CC 68[00000000]            push BUFF
   538 000003D1 E8(F6FFFFFF)            call WRITE
   539 000003D6 83C408                  add ESP,4*2
   540                                 
   541                                 
   542                                 
   543 000003D9 A1[00000000]            mov EAX,[I]
   544 000003DE 40                      inc EAX
   545 000003DF A3[00000000]            mov [I],EAX
   546                                 
   547 000003E4 E980FEFFFF              jmp LJ16
   548                                 LJ17:
   549                                 
   550                                 
   551                                 
   552 000003E9 68[00000000]            push COLLS
   553 000003EE 68[00000000]            push SCRATCH
   554 000003F3 E8(F6FFFFFF)            call IFORM
   555 000003F8 83C408                  add ESP,4*2
   556                                 
   557                                 
   558 000003FB B800000000              mov EAX,0
   559 00000400 A3[00000000]            mov [BUFF],EAX
   560                                 
   561                                 
   562 00000405 68[00000000]            push BUFF
   563 0000040A 68[00000000]            push COLLISIONS
   564 0000040F E8(F6FFFFFF)            call CAT2
   565 00000414 83C408                  add ESP,4*2
   566                                 
   567                                 
   568 00000417 68[00000000]            push BUFF
   569 0000041C 68[00000000]            push SCRATCH
   570 00000421 E8(F6FFFFFF)            call CAT2
   571 00000426 83C408                  add ESP,4*2
   572                                 
   573                                 
   574 00000429 68[00000000]            push OUTCH
   575 0000042E 68[00000000]            push BUFF
   576 00000433 E8(F6FFFFFF)            call WRITE
   577 00000438 83C408                  add ESP,4*2
   578                                 
   579                                 
   580 0000043B 89EC                    mov ESP,EBP
   581 0000043D 5D                      pop EBP
   582 0000043E C3                      ret
   583                                 
   584                                 [section .data]
   585                                 T3Z1:
   586 000003EC 00000000                times 1 dd 0
   587                                 [section .text]
   588                                 
   589                                  end
