     1                                 %line 1+1 symacc.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 [global progr]
     7                                 [extern exit]
     8                                 
     9                                 
    10                                 
    11                                 
    12                                 
    13                                 
    14                                 
    15                                 [global LOOKS]
    16                                 [global GETS]
    17                                 [global PUTS]
    18                                 [global GETWRD]
    19                                 
    20                                 [global A2B40]
    21                                 [global B402A]
    22                                 
    23                                 [global COLLS]
    24                                 
    25                                 
    26                                 
    27                                 [section .data]
    28                                 TABLE:
    29 00000000 00000000<rept>          times 8192 dd 0
    30                                 
    31                                 STRING:
    32 00008000 00000000<rept>          times 7 dd 0
    33                                 
    34                                 I:
    35 0000801C 00000000                times 1 dd 0
    36                                 J:
    37 00008020 00000000                times 1 dd 0
    38                                 CHAR:
    39 00008024 00000000                times 1 dd 0
    40                                 LEN:
    41 00008028 00000000                times 1 dd 0
    42                                 B:
    43 0000802C 00000000                times 1 dd 0
    44                                 CODE:
    45 00008030 00000000                times 1 dd 0
    46                                 
    47                                 MASKE:
    48 00008034 FEFFFFFF                dd -2
    49                                 
    50                                 MASKV:
    51 00008038 FFFFFFFF                dd -1
    52                                 
    53                                 COLFLG:
    54 0000803C 00000000                times 1 dd 0
    55                                 COLLS:
    56 00008040 00000000                dd 0
    57                                 
    58                                 
    59                                 
    60                                 
    61                                 
    62                                 
    63                                 [section .text]
    64                                 
    65                                 A2B40:
    66 00000000 55                      push EBP
    67 00000001 89E5                    mov EBP,ESP
    68                                 
    69                                 
    70                                 
    71                                 
    72                                 
    73                                 
    74 00000003 8B5D08                  mov EBX,[EBP+8]
    75 00000006 8B03                    mov EAX,[EBX]
    76 00000008 A3[00000000]            mov [LEN],EAX
    77                                 
    78                                 
    79 0000000D A1[00000000]            mov EAX,[LEN]
    80 00000012 83E806                  sub EAX,6
    81 00000015 7E08                    jle LJ1
    82                                 
    83                                 
    84 00000017 B806000000              mov EAX,6
    85 0000001C A3[00000000]            mov [LEN],EAX
    86                                 
    87                                 LJ1:
    88                                 
    89                                 
    90 00000021 A1[00000000]            mov EAX,[LEN]
    91 00000026 A3[00000000]            mov [I],EAX
    92                                 
    93                                 
    94 0000002B B800000000              mov EAX,0
    95 00000030 A3[00000000]            mov [CODE],EAX
    96                                 
    97                                 LJ2:
    98                                 
    99 00000035 A1[00000000]            mov EAX,[I]
   100 0000003A 09C0                    or EAX,EAX
   101 0000003C 0F8E7D000000            jle LJ3
   102                                 
   103                                 
   104 00000042 A1[00000000]            mov EAX,[I]
   105 00000047 C1E002                  sal EAX,2
   106                                 
   107 0000004A 8B5D08                  mov EBX,[EBP+8]
   108 0000004D 01D8                    add EAX,EBX
   109 0000004F 8B00                    mov EAX,[EAX]
   110 00000051 A3[00000000]            mov [CHAR],EAX
   111                                 
   112                                 
   113 00000056 A1[00000000]            mov EAX,[CHAR]
   114 0000005B 83E839                  sub EAX,57
   115 0000005E 7F0D                    jg LJ4
   116                                 
   117                                 
   118 00000060 A1[00000000]            mov EAX,[CHAR]
   119 00000065 83E815                  sub EAX,21
   120 00000068 A3[00000000]            mov [B],EAX
   121                                 
   122 0000006D EB2E                    jmp LJ5
   123                                 LJ4:
   124                                 
   125 0000006F A1[00000000]            mov EAX,[CHAR]
   126 00000074 83E85A                  sub EAX,90
   127 00000077 7F0D                    jg LJ6
   128                                 
   129                                 
   130 00000079 A1[00000000]            mov EAX,[CHAR]
   131 0000007E 83E840                  sub EAX,64
   132 00000081 A3[00000000]            mov [B],EAX
   133                                 
   134 00000086 EB15                    jmp LJ7
   135                                 LJ6:
   136                                 
   137 00000088 A1[00000000]            mov EAX,[CHAR]
   138 0000008D 83E87A                  sub EAX,122
   139 00000090 7F0B                    jg LJ8
   140                                 
   141                                 
   142 00000092 A1[00000000]            mov EAX,[CHAR]
   143 00000097 83E860                  sub EAX,96
   144 0000009A A3[00000000]            mov [B],EAX
   145                                 
   146                                 LJ8:
   147                                 LJ7:
   148                                 LJ5:
   149                                 
   150                                 
   151 0000009F B828000000              mov EAX,40
   152 000000A4 F72D[00000000]          imul dword [CODE]
   153 000000AA 0305[00000000]          add EAX,[B]
   154 000000B0 A3[00000000]            mov [CODE],EAX
   155                                 
   156                                 
   157 000000B5 A1[00000000]            mov EAX,[I]
   158 000000BA 48                      dec EAX
   159 000000BB A3[00000000]            mov [I],EAX
   160                                 
   161 000000C0 E96BFFFFFF              jmp LJ2
   162                                 LJ3:
   163                                 
   164                                 
   165 000000C5 A1[00000000]            mov EAX,[CODE]
   166                                 
   167 000000CA 89EC                    mov ESP,EBP
   168 000000CC 5D                      pop EBP
   169 000000CD C3                      ret
   170                                 
   171                                 
   172                                 
   173                                 
   174                                 
   175                                 
   176                                 
   177                                 B402A:
   178 000000CE 55                      push EBP
   179 000000CF 89E5                    mov EBP,ESP
   180                                 
   181                                 
   182                                 
   183                                 
   184                                 
   185                                 
   186                                 
   187 000000D1 8B5D0C                  mov EBX,[EBP+12]
   188 000000D4 8B03                    mov EAX,[EBX]
   189 000000D6 A3[00000000]            mov [B],EAX
   190                                 
   191                                 
   192 000000DB B800000000              mov EAX,0
   193 000000E0 A3[00000000]            mov [I],EAX
   194                                 
   195                                 LJ9:
   196                                 
   197 000000E5 A1[00000000]            mov EAX,[I]
   198 000000EA 83E806                  sub EAX,6
   199 000000ED 0F8D81000000            jge LJ10
   200                                 
   201                                 
   202 000000F3 A1[00000000]            mov EAX,[I]
   203 000000F8 40                      inc EAX
   204 000000F9 A3[00000000]            mov [I],EAX
   205                                 
   206                                 
   207 000000FE A1[00000000]            mov EAX,[B]
   208 00000103 99                      cdq
   209 00000104 B928000000              mov ECX,40
   210 00000109 F7F9                    idiv dword ECX
   211 0000010B 89D0                    mov EAX,EDX
   212 0000010D A3[00000000]            mov [CHAR],EAX
   213                                 
   214                                 
   215 00000112 A1[00000000]            mov EAX,[B]
   216 00000117 99                      cdq
   217 00000118 B928000000              mov ECX,40
   218 0000011D F7F9                    idiv dword ECX
   219 0000011F A3[00000000]            mov [B],EAX
   220                                 
   221                                 
   222 00000124 A1[00000000]            mov EAX,[CHAR]
   223 00000129 09C0                    or EAX,EAX
   224                                 
   225 0000012B 7500                    jne LJ11
   226 0000012D EB49                    jmp LJ10
   227                                 
   228                                 LJ11:
   229                                 
   230                                 
   231 0000012F A1[00000000]            mov EAX,[CHAR]
   232 00000134 83E81A                  sub EAX,26
   233                                 
   234 00000137 7F0D                    jg LJ12
   235                                 
   236 00000139 A1[00000000]            mov EAX,[CHAR]
   237 0000013E 83C040                  add EAX,64
   238 00000141 A3[00000000]            mov [CHAR],EAX
   239                                 
   240 00000146 EB0B                    jmp LJ13
   241                                 LJ12:
   242                                 
   243 00000148 A1[00000000]            mov EAX,[CHAR]
   244 0000014D 83C015                  add EAX,21
   245 00000150 A3[00000000]            mov [CHAR],EAX
   246                                 
   247                                 LJ13:
   248                                 
   249                                 
   250 00000155 A1[00000000]            mov EAX,[I]
   251 0000015A C1E002                  sal EAX,2
   252                                 
   253 0000015D 8B5D08                  mov EBX,[EBP+8]
   254 00000160 01D8                    add EAX,EBX
   255 00000162 A3[00000000]            mov [T3Z],EAX
   256 00000167 A1[00000000]            mov EAX,[CHAR]
   257 0000016C 89C2                    mov EDX,EAX
   258 0000016E A1[00000000]            mov EAX,[T3Z]
   259 00000173 8910                    mov [EAX],EDX
   260                                 
   261 00000175 E966FFFFFF              jmp LJ9
   262                                 LJ10:
   263                                 
   264                                 
   265 0000017A A1[00000000]            mov EAX,[I]
   266                                 
   267 0000017F 8B5D08                  mov EBX,[EBP+8]
   268 00000182 8903                    mov [EBX],EAX
   269                                 
   270                                 
   271 00000184 89EC                    mov ESP,EBP
   272 00000186 5D                      pop EBP
   273 00000187 C3                      ret
   274                                 
   275                                 [section .data]
   276                                 T3Z:
   277 00008044 00000000<rept>          times 2 dd 0
   278                                 [section .text]
   279                                 
   280                                 
   281                                 
   282                                 
   283                                 
   284                                 
   285                                 
   286                                 
   287                                 
   288                                 LOOKS:
   289 00000188 55                      push EBP
   290 00000189 89E5                    mov EBP,ESP
   291                                 
   292                                 
   293                                 
   294                                 
   295                                 
   296                                 
   297                                 
   298 0000018B B8FF7F0000              mov EAX,32767
   299 00000190 D1E0                    sal EAX,1
   300 00000192 83C801                  or EAX,1
   301 00000195 A3[00000000]            mov [MASKV],EAX
   302                                 
   303                                 
   304 0000019A B800000000              mov EAX,0
   305 0000019F A3[00000000]            mov [COLFLG],EAX
   306                                 
   307                                 
   308                                 
   309 000001A4 8B5D10                  mov EBX,[EBP+16]
   310 000001A7 8B03                    mov EAX,[EBX]
   311                                 
   312 000001A9 99                      cdq
   313 000001AA B9FF1F0000              mov ECX,8191
   314 000001AF F7F9                    idiv dword ECX
   315 000001B1 89D0                    mov EAX,EDX
   316 000001B3 A3[00000000]            mov [I],EAX
   317                                 
   318                                 
   319 000001B8 A1[00000000]            mov EAX,[I]
   320 000001BD 2305[00000000]          and EAX,[MASKE]
   321 000001C3 A3[00000000]            mov [I],EAX
   322                                 
   323                                 
   324 000001C8 A1[00000000]            mov EAX,[I]
   325 000001CD A3[00000000]            mov [J],EAX
   326                                 
   327                                 LJ14:
   328                                 
   329                                 
   330 000001D2 A1[00000000]            mov EAX,[I]
   331 000001D7 C1E002                  sal EAX,2
   332 000001DA 05[00000000]            add EAX,TABLE
   333 000001DF 8B00                    mov EAX,[EAX]
   334 000001E1 09C0                    or EAX,EAX
   335                                 
   336 000001E3 7566                    jne LJ16
   337                                 
   338 000001E5 A1[00000000]            mov EAX,[I]
   339 000001EA C1E002                  sal EAX,2
   340 000001ED 05[00000000]            add EAX,TABLE
   341 000001F2 A3[00000000]            mov [T5Z],EAX
   342                                 
   343 000001F7 8B5D10                  mov EBX,[EBP+16]
   344 000001FA 8B03                    mov EAX,[EBX]
   345 000001FC 89C2                    mov EDX,EAX
   346 000001FE A1[00000000]            mov EAX,[T5Z]
   347 00000203 8910                    mov [EAX],EDX
   348                                 
   349                                 
   350 00000205 A1[00000000]            mov EAX,[I]
   351 0000020A 40                      inc EAX
   352 0000020B C1E002                  sal EAX,2
   353 0000020E 05[00000000]            add EAX,TABLE
   354 00000213 A3[00000000]            mov [T5Z1],EAX
   355                                 
   356 00000218 8B5D08                  mov EBX,[EBP+8]
   357 0000021B 8B03                    mov EAX,[EBX]
   358 0000021D C1E010                  sal EAX,16
   359                                 
   360 00000220 8B5D0C                  mov EBX,[EBP+12]
   361 00000223 0B03                    or EAX,[EBX]
   362 00000225 89C2                    mov EDX,EAX
   363 00000227 A1[00000000]            mov EAX,[T5Z1]
   364 0000022C 8910                    mov [EAX],EDX
   365                                 
   366                                 
   367 0000022E A1[00000000]            mov EAX,[COLFLG]
   368 00000233 09C0                    or EAX,EAX
   369 00000235 7409                    jz LJ17
   370                                 
   371                                 
   372 00000237 A1[00000000]            mov EAX,[COLLS]
   373 0000023C 40                      inc EAX
   374 0000023D A3[00000000]            mov [COLLS],EAX
   375                                 
   376                                 LJ17:
   377                                 
   378                                 
   379 00000242 A1[00000000]            mov EAX,[I]
   380                                 
   381 00000247 89EC                    mov ESP,EBP
   382 00000249 5D                      pop EBP
   383 0000024A C3                      ret
   384                                 
   385 0000024B EB55                    jmp LJ18
   386                                 LJ16:
   387                                 
   388 0000024D A1[00000000]            mov EAX,[I]
   389 00000252 C1E002                  sal EAX,2
   390 00000255 05[00000000]            add EAX,TABLE
   391 0000025A 8B00                    mov EAX,[EAX]
   392                                 
   393 0000025C 8B5D10                  mov EBX,[EBP+16]
   394 0000025F 2B03                    sub EAX,[EBX]
   395                                 
   396 00000261 753F                    jne LJ19
   397                                 
   398 00000263 A1[00000000]            mov EAX,[I]
   399 00000268 40                      inc EAX
   400 00000269 C1E002                  sal EAX,2
   401 0000026C 05[00000000]            add EAX,TABLE
   402 00000271 8B00                    mov EAX,[EAX]
   403 00000273 A3[00000000]            mov [B],EAX
   404                                 
   405                                 
   406 00000278 A1[00000000]            mov EAX,[B]
   407 0000027D 2305[00000000]          and EAX,[MASKV]
   408                                 
   409 00000283 8B5D0C                  mov EBX,[EBP+12]
   410 00000286 8903                    mov [EBX],EAX
   411                                 
   412                                 
   413 00000288 A1[00000000]            mov EAX,[B]
   414 0000028D C1F810                  sar EAX,16
   415 00000290 2305[00000000]          and EAX,[MASKV]
   416                                 
   417 00000296 8B5D08                  mov EBX,[EBP+8]
   418 00000299 8903                    mov [EBX],EAX
   419                                 
   420                                 
   421 0000029B A1[00000000]            mov EAX,[I]
   422                                 
   423 000002A0 89EC                    mov ESP,EBP
   424 000002A2 5D                      pop EBP
   425 000002A3 C3                      ret
   426                                 
   427                                 LJ19:
   428                                 LJ18:
   429                                 
   430                                 
   431 000002A4 A1[00000000]            mov EAX,[I]
   432 000002A9 83C002                  add EAX,2
   433 000002AC A3[00000000]            mov [I],EAX
   434                                 
   435                                 
   436 000002B1 B801000000              mov EAX,1
   437 000002B6 A3[00000000]            mov [COLFLG],EAX
   438                                 
   439                                 
   440 000002BB A1[00000000]            mov EAX,[I]
   441 000002C0 2DFF1F0000              sub EAX,8191
   442                                 
   443 000002C5 7E0D                    jle LJ20
   444                                 
   445 000002C7 A1[00000000]            mov EAX,[I]
   446 000002CC 2DFF1F0000              sub EAX,8191
   447 000002D1 A3[00000000]            mov [I],EAX
   448                                 
   449                                 LJ20:
   450                                 
   451                                 
   452 000002D6 A1[00000000]            mov EAX,[I]
   453 000002DB 2B05[00000000]          sub EAX,[J]
   454 000002E1 0F85E5FEFFFF            jne LJ14
   455                                 LJ15:
   456                                 
   457                                 
   458 000002E7 B801000000              mov EAX,1
   459 000002EC F7D8                    neg EAX
   460                                 
   461 000002EE 89EC                    mov ESP,EBP
   462 000002F0 5D                      pop EBP
   463 000002F1 C3                      ret
   464                                 
   465                                 [section .data]
   466                                 T5Z:
   467 0000804C 00000000<rept>          times 2 dd 0
   468                                 [section .text]
   469                                 [section .data]
   470                                 T5Z1:
   471 00008054 00000000                times 1 dd 0
   472                                 [section .text]
   473                                 
   474                                 
   475                                 
   476                                 
   477                                 
   478                                 
   479                                 GETS:
   480 000002F2 55                      push EBP
   481 000002F3 89E5                    mov EBP,ESP
   482                                 
   483                                 
   484                                 
   485                                 
   486                                 
   487                                 
   488                                 
   489                                 
   490 000002F5 8B5D10                  mov EBX,[EBP+16]
   491 000002F8 8B03                    mov EAX,[EBX]
   492 000002FA 40                      inc EAX
   493 000002FB C1E002                  sal EAX,2
   494 000002FE 05[00000000]            add EAX,TABLE
   495 00000303 8B00                    mov EAX,[EAX]
   496 00000305 A3[00000000]            mov [B],EAX
   497                                 
   498                                 
   499 0000030A A1[00000000]            mov EAX,[B]
   500 0000030F 2305[00000000]          and EAX,[MASKV]
   501                                 
   502 00000315 8B5D0C                  mov EBX,[EBP+12]
   503 00000318 8903                    mov [EBX],EAX
   504                                 
   505                                 
   506 0000031A A1[00000000]            mov EAX,[B]
   507 0000031F C1F810                  sar EAX,16
   508 00000322 2305[00000000]          and EAX,[MASKV]
   509                                 
   510 00000328 8B5D08                  mov EBX,[EBP+8]
   511 0000032B 8903                    mov [EBX],EAX
   512                                 
   513                                 
   514 0000032D 89EC                    mov ESP,EBP
   515 0000032F 5D                      pop EBP
   516 00000330 C3                      ret
   517                                 
   518                                 
   519                                 
   520                                 
   521                                 
   522                                 
   523                                 
   524                                 PUTS:
   525 00000331 55                      push EBP
   526 00000332 89E5                    mov EBP,ESP
   527                                 
   528                                 
   529                                 
   530                                 
   531                                 
   532                                 
   533                                 
   534                                 
   535 00000334 8B5D10                  mov EBX,[EBP+16]
   536 00000337 8B03                    mov EAX,[EBX]
   537 00000339 40                      inc EAX
   538 0000033A C1E002                  sal EAX,2
   539 0000033D 05[00000000]            add EAX,TABLE
   540 00000342 A3[00000000]            mov [T9Z1],EAX
   541                                 
   542 00000347 8B5D08                  mov EBX,[EBP+8]
   543 0000034A 8B03                    mov EAX,[EBX]
   544 0000034C C1E010                  sal EAX,16
   545                                 
   546 0000034F 8B5D0C                  mov EBX,[EBP+12]
   547 00000352 0B03                    or EAX,[EBX]
   548 00000354 89C2                    mov EDX,EAX
   549 00000356 A1[00000000]            mov EAX,[T9Z1]
   550 0000035B 8910                    mov [EAX],EDX
   551                                 
   552                                 
   553 0000035D 89EC                    mov ESP,EBP
   554 0000035F 5D                      pop EBP
   555 00000360 C3                      ret
   556                                 
   557                                 [section .data]
   558                                 T9Z1:
   559 00008058 00000000                times 1 dd 0
   560                                 [section .text]
   561                                 
   562                                 
   563                                 
   564                                 
   565                                 
   566                                 
   567                                 GETWRD:
   568 00000361 55                      push EBP
   569 00000362 89E5                    mov EBP,ESP
   570                                 
   571                                 
   572                                 
   573                                 
   574                                 
   575                                 
   576                                 
   577 00000364 8B5D0C                  mov EBX,[EBP+12]
   578 00000367 8B03                    mov EAX,[EBX]
   579 00000369 C1E002                  sal EAX,2
   580 0000036C 05[00000000]            add EAX,TABLE
   581 00000371 8B00                    mov EAX,[EAX]
   582                                 
   583 00000373 8B5D08                  mov EBX,[EBP+8]
   584 00000376 8903                    mov [EBX],EAX
   585                                 
   586                                 
   587 00000378 89EC                    mov ESP,EBP
   588 0000037A 5D                      pop EBP
   589 0000037B C3                      ret
   590                                 
   591                                 
   592                                 
   593                                  end
