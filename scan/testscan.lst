     1                                 %line 1+1 testscan.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 
     8                                 
     9                                 [global TESTSCAN]
    10                                 
    11                                 [global progr]
    12                                 [extern exit]
    13                                 
    14                                 [global TESTSCAN]
    15                                 [section .text]
    16                                 progr:
    17 00000000 55                      push EBP
    18 00000001 89E5                    mov EBP,ESP
    19 00000003 EBFE                    jmp TESTSCAN
    20                                 
    21                                 
    22                                 [extern WRITE]
    23                                 
    24                                 [extern SCAN]
    25                                 [extern INITSYM]
    26                                 [extern DMPLIST]
    27                                 [extern SHOTOKS]
    28                                 
    29                                 [extern SHOW]
    30                                 
    31                                 [extern OUTCH]
    32                                 [extern COLLS]
    33                                 
    34                                 
    35                                 [section .data]
    36                                 GREET:
    37 00000000 22000000                dd 34
    38 00000004 42000000                dd 66
    39 00000008 65000000                dd 101
    40 0000000C 67000000                dd 103
    41 00000010 69000000                dd 105
    42 00000014 6E000000                dd 110
    43 00000018 20000000                dd 32
    44 0000001C 53000000                dd 83
    45 00000020 6D000000                dd 109
    46 00000024 61000000                dd 97
    47 00000028 6C000000                dd 108
    48 0000002C 6C000000                dd 108
    49 00000030 20000000                dd 32
    50 00000034 53000000                dd 83
    51 00000038 43000000                dd 67
    52 0000003C 41000000                dd 65
    53 00000040 4E000000                dd 78
    54 00000044 20000000                dd 32
    55 00000048 54000000                dd 84
    56 0000004C 65000000                dd 101
    57 00000050 73000000                dd 115
    58 00000054 74000000                dd 116
    59 00000058 20000000                dd 32
    60 0000005C 77000000                dd 119
    61 00000060 69000000                dd 105
    62 00000064 74000000                dd 116
    63 00000068 68000000                dd 104
    64 0000006C 20000000                dd 32
    65 00000070 49000000                dd 73
    66 00000074 4E000000                dd 78
    67 00000078 49000000                dd 73
    68 0000007C 54000000                dd 84
    69 00000080 53000000                dd 83
    70 00000084 59000000                dd 89
    71 00000088 4D000000                dd 77
    72                                 
    73                                 DONE:
    74 0000008C 09000000                dd 9
    75 00000090 53000000                dd 83
    76 00000094 63000000                dd 99
    77 00000098 61000000                dd 97
    78 0000009C 6E000000                dd 110
    79 000000A0 20000000                dd 32
    80 000000A4 44000000                dd 68
    81 000000A8 6F000000                dd 111
    82 000000AC 6E000000                dd 110
    83 000000B0 65000000                dd 101
    84                                 
    85                                 NCOLLS:
    86 000000B4 0A000000                dd 10
    87 000000B8 43000000                dd 67
    88 000000BC 6F000000                dd 111
    89 000000C0 6C000000                dd 108
    90 000000C4 6C000000                dd 108
    91 000000C8 69000000                dd 105
    92 000000CC 73000000                dd 115
    93 000000D0 69000000                dd 105
    94 000000D4 6F000000                dd 111
    95 000000D8 6E000000                dd 110
    96 000000DC 73000000                dd 115
    97                                 
    98                                 
    99                                 [section .text]
   100                                 TESTSCAN:
   101                                 
   102                                 
   103 00000005 68[00000000]            push OUTCH
   104 0000000A 68[00000000]            push GREET
   105 0000000F E8(F6FFFFFF)            call WRITE
   106 00000014 83C408                  add ESP,4*2
   107                                 
   108                                 
   109 00000017 E8(F6FFFFFF)            call INITSYM
   110                                 
   111                                 
   112 0000001C E8(F6FFFFFF)            call DMPLIST
   113                                 
   114                                 
   115 00000021 E8(F6FFFFFF)            call SCAN
   116                                 
   117                                 
   118 00000026 68[00000000]            push OUTCH
   119 0000002B 68[00000000]            push DONE
   120 00000030 E8(F6FFFFFF)            call WRITE
   121 00000035 83C408                  add ESP,4*2
   122                                 
   123                                 
   124 00000038 E8(F6FFFFFF)            call SHOTOKS
   125                                 
   126                                 
   127 0000003D 68[00000000]            push NCOLLS
   128 00000042 68[00000000]            push COLLS
   129 00000047 E8(F6FFFFFF)            call SHOW
   130 0000004C 83C408                  add ESP,4*2
   131                                 
   132                                 
   133 0000004F 89EC                    mov ESP,EBP
   134 00000051 5D                      pop EBP
   135 00000052 C3                      ret
   136                                 
   137                                 
   138                                  end
