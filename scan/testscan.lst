     1                                 %line 1+1 testscan.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 
     8                                 [global TESTSCAN]
     9                                 
    10                                 [global progr]
    11                                 [extern exit]
    12                                 
    13                                 [global TESTSCAN]
    14                                 [section .text]
    15                                 progr:
    16 00000000 55                      push EBP
    17 00000001 89E5                    mov EBP,ESP
    18 00000003 EBFE                    jmp TESTSCAN
    19                                 
    20                                 [global BUFF]
    21                                 
    22                                 
    23                                 [extern WRITE]
    24                                 
    25                                 [extern SCAN]
    26                                 [extern INITSYM]
    27                                 [extern DMPLIST]
    28                                 [extern SHOTOKS]
    29                                 
    30                                 [extern SHOW]
    31                                 
    32                                 [extern OUTCH]
    33                                 [extern COLLS]
    34                                 
    35                                 
    36                                 [section .data]
    37                                 GREET:
    38 00000000 22000000                dd 34
    39 00000004 42000000                dd 66
    40 00000008 65000000                dd 101
    41 0000000C 67000000                dd 103
    42 00000010 69000000                dd 105
    43 00000014 6E000000                dd 110
    44 00000018 20000000                dd 32
    45 0000001C 53000000                dd 83
    46 00000020 6D000000                dd 109
    47 00000024 61000000                dd 97
    48 00000028 6C000000                dd 108
    49 0000002C 6C000000                dd 108
    50 00000030 20000000                dd 32
    51 00000034 53000000                dd 83
    52 00000038 43000000                dd 67
    53 0000003C 41000000                dd 65
    54 00000040 4E000000                dd 78
    55 00000044 20000000                dd 32
    56 00000048 54000000                dd 84
    57 0000004C 65000000                dd 101
    58 00000050 73000000                dd 115
    59 00000054 74000000                dd 116
    60 00000058 20000000                dd 32
    61 0000005C 77000000                dd 119
    62 00000060 69000000                dd 105
    63 00000064 74000000                dd 116
    64 00000068 68000000                dd 104
    65 0000006C 20000000                dd 32
    66 00000070 49000000                dd 73
    67 00000074 4E000000                dd 78
    68 00000078 49000000                dd 73
    69 0000007C 54000000                dd 84
    70 00000080 53000000                dd 83
    71 00000084 59000000                dd 89
    72 00000088 4D000000                dd 77
    73                                 
    74                                 DONE:
    75 0000008C 09000000                dd 9
    76 00000090 53000000                dd 83
    77 00000094 63000000                dd 99
    78 00000098 61000000                dd 97
    79 0000009C 6E000000                dd 110
    80 000000A0 20000000                dd 32
    81 000000A4 44000000                dd 68
    82 000000A8 6F000000                dd 111
    83 000000AC 6E000000                dd 110
    84 000000B0 65000000                dd 101
    85                                 
    86                                 NCOLLS:
    87 000000B4 0A000000                dd 10
    88 000000B8 43000000                dd 67
    89 000000BC 6F000000                dd 111
    90 000000C0 6C000000                dd 108
    91 000000C4 6C000000                dd 108
    92 000000C8 69000000                dd 105
    93 000000CC 73000000                dd 115
    94 000000D0 69000000                dd 105
    95 000000D4 6F000000                dd 111
    96 000000D8 6E000000                dd 110
    97 000000DC 73000000                dd 115
    98                                 
    99                                 
   100                                 [section .text]
   101                                 TESTSCAN:
   102                                 
   103                                 
   104 00000005 68[00000000]            push OUTCH
   105 0000000A 68[00000000]            push GREET
   106 0000000F E8(F6FFFFFF)            call WRITE
   107 00000014 83C408                  add ESP,4*2
   108                                 
   109                                 
   110 00000017 E8(F6FFFFFF)            call INITSYM
   111                                 
   112                                 
   113 0000001C E8(F6FFFFFF)            call DMPLIST
   114                                 
   115                                 
   116 00000021 E8(F6FFFFFF)            call SCAN
   117                                 
   118                                 
   119 00000026 68[00000000]            push OUTCH
   120 0000002B 68[00000000]            push DONE
   121 00000030 E8(F6FFFFFF)            call WRITE
   122 00000035 83C408                  add ESP,4*2
   123                                 
   124                                 
   125 00000038 E8(F6FFFFFF)            call SHOTOKS
   126                                 
   127                                 
   128 0000003D 68[00000000]            push NCOLLS
   129 00000042 68[00000000]            push COLLS
   130 00000047 E8(F6FFFFFF)            call SHOW
   131 0000004C 83C408                  add ESP,4*2
   132                                 
   133                                 
   134 0000004F 89EC                    mov ESP,EBP
   135 00000051 5D                      pop EBP
   136 00000052 C3                      ret
   137                                 
   138                                 
   139                                  end
